{"version":3,"sources":["App.js","index.js"],"names":["App","boardRef","useRef","useState","Array","fill","board","setBoard","speed","setSpeed","rendering","setRendering","lineCount","setLineCount","getCoordinatesFromPattern","pattern","x","y","coordinates","forEach","e","i","split","map","el","il","push","initialState","array","newPiece","Math","floor","random","global","parts","class","join","find","handleKeyDown","code","repeat","current","piece","baseBoard","prev","newPattern","length","useEffect","window","addEventListener","handleKeyUp","interval","setInterval","includes","splice","unshift","removeEventListener","clearInterval","currBoard","shadowPiece","cell","toUpperCase","className","uuidv4","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c743cffb.chunk.js","sourcesContent":["import { v4 as uuidv4 } from 'uuid';\r\nimport './App.css';\r\nimport { useEffect, useState, useRef } from 'react';\r\n\r\n\r\nfunction App() {\r\n\r\n  const boardRef = useRef();\r\n  const [board, setBoard] = useState(new Array(21).fill('0000000000').fill('1111111111', 20))\r\n  const [speed, setSpeed] = useState(1000)\r\n  const [rendering, setRendering] = useState(0)\r\n  const [lineCount, setLineCount] = useState(0)\r\n\r\n\r\n\r\n  function getCoordinatesFromPattern(pattern, x, y) {\r\n    let coordinates = []\r\n    pattern.forEach((e, i) => {\r\n      e.split('').map((el, il) => {\r\n        if (el != 0) {\r\n          coordinates.push({ x: x + il, y: y + i })\r\n        }\r\n      })\r\n    })\r\n    return coordinates\r\n  }\r\n\r\n  function initialState() {\r\n\r\n    function pieceGenerator(array) {\r\n      return array[Math.floor(Math.random() * 7)]\r\n    }\r\n\r\n\r\n\r\n    const pattern = [\r\n      ['0000', '0oo0', '0oo0', '0000'],\r\n      ['0000', 'iiii', '0000', '0000'],\r\n      ['00l', 'lll', '000'],\r\n      ['j00', 'jjj', '000'],\r\n      ['0ss', 'ss0', '000'],\r\n      ['zz0', '0zz', '000'],\r\n      ['0t0', 'ttt', '000']\r\n    ]\r\n\r\n    let newPiece = {\r\n      pattern: pieceGenerator(pattern),\r\n      global: { x: 0, y: 0 },\r\n      parts: [{ x: 0, y: 0 }]\r\n    }\r\n\r\n    newPiece.class = [...newPiece.pattern.join('')].find(e => e != 0)\r\n    newPiece.global = { x: 3, y: 0 }\r\n    newPiece.parts = getCoordinatesFromPattern(\r\n      newPiece.pattern,\r\n      newPiece.global.x,\r\n      newPiece.global.y\r\n    )\r\n    return newPiece\r\n  }\r\n\r\n  useEffect(() => {\r\n\r\n    boardRef.current = {\r\n      piece: { ...initialState() },\r\n      board: new Array(21).fill('0000000000').fill('1111111111', 20),\r\n      baseBoard: new Array(21).fill('0000000000').fill('1111111111', 20)\r\n    }\r\n\r\n  }, [])\r\n\r\n  function handleKeyDown(e) {\r\n\r\n    switch (e.code) {\r\n      case 'ArrowDown':\r\n        if (!e.repeat) {\r\n          setSpeed(50)\r\n        }\r\n        break;\r\n\r\n      case 'ArrowLeft':\r\n        if (boardRef.current.piece.parts.find((e) => e.x <= 0) || boardRef.current.piece.parts.find((e) => boardRef.current.baseBoard[e.y][e.x - 1] != 0)) return\r\n        boardRef.current.piece.parts.forEach(e => e.x = e.x - 1)\r\n        boardRef.current.piece.global.x--\r\n        setRendering((prev) => prev + 1)\r\n        break;\r\n      case 'ArrowRight':\r\n        if (boardRef.current.piece.parts.find((e) => e.x >= 9) || boardRef.current.piece.parts.find((e) => boardRef.current.baseBoard[e.y][e.x + 1] != 0)) return\r\n        boardRef.current.piece.parts.forEach(e => e.x = e.x + 1)\r\n        boardRef.current.piece.global.x++\r\n        setRendering((prev) => prev + 1)\r\n        break;\r\n      case 'KeyW':\r\n        {\r\n          let newPattern = boardRef.current.piece.pattern.map((e, i) => boardRef.current.piece.pattern.map((el) => el[(el.length - 1) - i]).join(''));\r\n          let coordinates = getCoordinatesFromPattern(newPattern, boardRef.current.piece.global.x, boardRef.current.piece.global.y)\r\n          if (coordinates.find((e) => boardRef.current.baseBoard[e.y][e.x] != 0)) return\r\n          boardRef.current.piece.parts = coordinates\r\n          boardRef.current.piece.pattern = newPattern\r\n          setRendering((prev) => prev + 1)\r\n        }\r\n        break;\r\n\r\n      case 'ArrowUp':\r\n        {\r\n          let newPattern = boardRef.current.piece.pattern.map((e, i) => boardRef.current.piece.pattern.map((el, y) => boardRef.current.piece.pattern[(boardRef.current.piece.pattern.length - 1) - y][i]).join(''));\r\n          let coordinates = getCoordinatesFromPattern(newPattern, boardRef.current.piece.global.x, boardRef.current.piece.global.y)\r\n          if (coordinates.find((e) => boardRef.current.baseBoard[e.y][e.x] != 0)) return\r\n          boardRef.current.piece.parts = coordinates\r\n          boardRef.current.piece.pattern = newPattern\r\n          setRendering((prev) => prev + 1)\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n\r\n  /* Controls  */\r\n  useEffect(() => {\r\n    window.addEventListener('keyup', handleKeyUp)\r\n    window.addEventListener('keydown', handleKeyDown)\r\n\r\n    let interval = setInterval(() => {\r\n\r\n      if (boardRef.current.piece.parts.find((e) => e.y >= 19) || boardRef.current.piece.parts.find((e) => boardRef.current.baseBoard[e.y + 1][e.x] != 0)) {\r\n        boardRef.current.board.forEach((e, i) => {\r\n          if(!e.includes('0') && i != 20) {\r\n            setLineCount( prev => prev + 1)\r\n            boardRef.current.board.splice(i, 1)\r\n            boardRef.current.board.unshift('0000000000')\r\n          }\r\n        })\r\n        boardRef.current.piece = { ...initialState() }\r\n        boardRef.current.baseBoard = [...boardRef.current.board]\r\n        setRendering((prev) => prev + 1)\r\n      }\r\n      else {\r\n        boardRef.current.piece.parts.forEach(e => e.y = e.y + 1)\r\n        boardRef.current.piece.global.y++\r\n        setRendering((prev) => prev + 1)\r\n      }\r\n    }, [speed])\r\n\r\n    function handleKeyUp(e) {\r\n      if (e.code == 'ArrowDown') {\r\n        setSpeed(1000)\r\n      }\r\n    }\r\n\r\n\r\n    return () => {\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      clearInterval(interval);\r\n    }\r\n  }, [speed])\r\n\r\n  // render  \r\n  useEffect(() => {\r\n\r\n    let currBoard = [...boardRef.current.baseBoard]\r\n    let shadowPiece = [...boardRef.current.piece.parts.map(e => ({ ...e }))]\r\n\r\n    while (!shadowPiece.find((e) => currBoard[e.y + 1][e.x] != 0)) {\r\n      shadowPiece = [...shadowPiece.map((e) => ({ ...e, y: e.y + 1 }))]\r\n    }\r\n\r\n    shadowPiece.forEach((e, i) => {\r\n      let cell = currBoard[e.y].split('')\r\n      cell[e.x] = boardRef.current.piece.class.toUpperCase()\r\n      currBoard[e.y] = cell.join('')\r\n    })\r\n    boardRef.current.piece.parts.forEach((e, i) => {\r\n      let cell = currBoard[e.y].split('')\r\n      cell[e.x] = boardRef.current.piece.class\r\n      currBoard[e.y] = cell.join('')\r\n    })\r\n\r\n    boardRef.current.board = [...currBoard]\r\n    setBoard([...currBoard])\r\n\r\n\r\n  }, [rendering])\r\n\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <span className=\"infos\">Score: {lineCount}</span>\r\n      <div className=\"board\">\r\n        {board.map((cell, i) => i != 20 && (\r\n          <div key={uuidv4()} className=\"row\">\r\n            {cell.split('').map((e) => <div key={uuidv4()} className={`cell ${e}-block`}></div>)}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}